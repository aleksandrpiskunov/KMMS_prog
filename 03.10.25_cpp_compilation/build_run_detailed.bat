#!/bin/bash

# Настройка имён файлов
MAIN="main.cpp"
EXE="example"

# Удаляем старый исполняемый файл, если есть
[ -f "$EXE" ] && rm "$EXE"

# Препроцессор: создаём файл main.ii
g++ -E "$MAIN" -o "${MAIN%.cpp}.ii"

# Ассемблерный исходник: создаём файл main.s
g++ -S "$MAIN" -o "${MAIN%.cpp}.s"

# Компиляция исходника в объектный файл
g++ -c "$MAIN" -o "${MAIN%.cpp}.o"

# Компоновка: собираем исполняемый файл
g++ "${MAIN%.cpp}.o" -o "$EXE"

# Запускаем программу, если она собралась успешно
if [[ -f "$EXE" ]]; then
    ./"$EXE"
fi
